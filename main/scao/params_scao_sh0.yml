---

main:
  root_dir:          './calib/SCAO'         # Root directory for calibration manager
  pixel_pupil:       160                    # Linear dimension of pupil phase array
  pixel_pitch:       0.05                   # [m] Pitch of the pupil phase array
  total_time:        0.050                  # [s] Total simulation running time
  time_step:         0.001                  # [s] Simulation time step

seeing:
  class:             'FuncGenerator'
  constant:          0.8                  # ["] seeing value
  func_type:         'SIN'                 # TODO necessary for factory.py line 217
  outputs: ['output']

wind_speed:
  class:             'FuncGenerator'
  constant:          [20.]                #,10.,20.,10.]      # [m/s] Wind speed value
  outputs: ['output']

wind_direction:
  class:             'FuncGenerator'
  constant:          [0.]#,270.,270.,90.]   # [degrees] Wind direction value
  outputs: ['output']

on_axis_source:
  class:             'Source'
  polar_coordinate:  [0.0, 0.0]           # [arcsec, degrees] source polar coordinates
  magnitude:         8                    # source magnitude
  wavelengthInNm:    750                   # [nm] wavelength

pupilstop:                                 # Default parameters (circular pupil)
  class: 'Pupilstop'

atmo:
  class:                'AtmoEvolution'
  L0:                   40                   # [m] Outer scale
  heights:              [119.] #,837,3045,12780]), # [m] layer heights at 0 zenith angle
  Cn2:                  [0.70] #,0.06,0.14,0.10]), # Cn2 weights (total must be eq 1)
  source_dict_ref:      ['on_axis_source']
  inputs:
    seeing: 'seeing.output'
    wind_speed: 'wind_speed.output'
    wind_direction: 'wind_direction.output'
  outputs: ['layer_list']

prop:
  class:                'AtmoPropagation'
  source_dict_ref:      ['on_axis_source']
  inputs:
    layer_list: ['atmo.layer_list',
                  'pupilstop',
                  'data_comm.out_layer:-1']
  outputs: ['out_on_axis_source_ef']

psf:
  class:             'PSF'
  wavelengthInNm:    1650                 # [nm] Imaging wavelength
  nd:                8                    # padding coefficient for PSF computation
  start_time:        0.05                # PSF integration start time
  inputs:
      in_ef:  'prop.out_on_axis_source_ef'
  outputs:  ['out_psf', 'out_sr']

data_store:
  class:             'DataStore'
  store_dir:         './output'             # Data result directory: 'store_dir'/TN/
  inputs:    
    input_list: ['res_ef-prop.out_on_axis_source_ef']

data_comm:
  class:             'DataComm'
  comm_port_in:         '1:8000'
  comm_port_out:        '9000'
  items_to_receive: ['out_layer']
  outputs_origin_proc: [1]
  inputs:    
    input_list: ['res_ef-prop.out_on_axis_source_ef']
  outputs: ['out_layer']
  

ph_disp:
  class:            'PhaseDisplay'
  inputs:
    phase:       "prop.out_on_axis_source_ef"
  window:           12
  title:            'PUPIL PHASE'
  disp_factor:      2